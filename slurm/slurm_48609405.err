Resolved 157 packages in 137ms
Uninstalled 1 package in 114ms
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 1 package in 88ms
 - multimodal-emotion-detection==0.1.0 (from file:///scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection)
 + multimodal-emotion-detection==0.1.0 (from file:///scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection)
/scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection/.venv/lib/python3.10/site-packages/lightning_fabric/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
[rank: 0] Global seed set to 42
/scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection/.venv/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 src/train.py experiment.name=ravdess_audio_video_bi ...
  rank_zero_warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection/.venv/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 src/train.py experiment.name=ravdess_audio_video_bi ...
  rank_zero_warn(
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection/.venv/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory outputs/ravdess_audio_video_big/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type             | Params
-------------------------------------------------
0 | encoders    | ModuleDict       | 6.0 M 
1 | fusion_head | Sequential       | 266 K 
2 | criterion   | CrossEntropyLoss | 0     
-------------------------------------------------
6.3 M     Trainable params
0         Non-trainable params
6.3 M     Total params
25.252    Total estimated model params size (MB)
/scache/scratch/pbm52/emotion-detection-mm/multimodal-emotion-detection/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:280: PossibleUserWarning: The number of training batches (36) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Metric val/loss improved. New best score: 2.082
Metric val/loss improved by 0.010 >= min_delta = 0.0. New best score: 2.071
Metric val/loss improved by 0.004 >= min_delta = 0.0. New best score: 2.068
Metric val/loss improved by 0.006 >= min_delta = 0.0. New best score: 2.061
Metric val/loss improved by 0.002 >= min_delta = 0.0. New best score: 2.059
Metric val/loss improved by 0.000 >= min_delta = 0.0. New best score: 2.059
Metric val/loss improved by 0.001 >= min_delta = 0.0. New best score: 2.057
Metric val/loss improved by 0.001 >= min_delta = 0.0. New best score: 2.057
Metric val/loss improved by 0.002 >= min_delta = 0.0. New best score: 2.054
Metric val/loss improved by 0.001 >= min_delta = 0.0. New best score: 2.053
Metric val/loss improved by 0.012 >= min_delta = 0.0. New best score: 2.041
Metric val/loss improved by 0.026 >= min_delta = 0.0. New best score: 2.015
Metric val/loss improved by 0.015 >= min_delta = 0.0. New best score: 2.000
Metric val/loss improved by 0.003 >= min_delta = 0.0. New best score: 1.997
Metric val/loss improved by 0.015 >= min_delta = 0.0. New best score: 1.983
Metric val/loss improved by 0.005 >= min_delta = 0.0. New best score: 1.977
Metric val/loss improved by 0.010 >= min_delta = 0.0. New best score: 1.968
Metric val/loss improved by 0.015 >= min_delta = 0.0. New best score: 1.953
Metric val/loss improved by 0.010 >= min_delta = 0.0. New best score: 1.943
Monitored metric val/loss did not improve in the last 15 records. Best score: 1.943. Signaling Trainer to stop.
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Restoring states from the checkpoint path at outputs/ravdess_audio_video_big/checkpoints/epoch=49-val/loss=1.9429.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at outputs/ravdess_audio_video_big/checkpoints/epoch=49-val/loss=1.9429.ckpt
